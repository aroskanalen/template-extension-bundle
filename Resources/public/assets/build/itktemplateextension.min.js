/**
 * @name ItkTemplateExtensionBundle
 * @version v1.1.2
 * @link https://github.com/itk-os2display/template-extension-bundle
 */
angular.module("templateExtensionModule",["ngQuill"]),angular.module("templateExtensionModule").config(["ngQuillConfigProvider",function(e){e.set({formats:["bold","italic","header","list"]})}]),angular.module("templateExtensionModule").directive("itkRichText",[function(){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(e){e.tools={italics:!0,bold:!0,h1:!0,h2:!0,list_bullet:!0,list_ordered:!0,clean:!0},e.tool.config&&e.tool.config.tools&&(e.tools=Object.assign(e.tools,e.tool.config.tools)),e.fontsizeEnabled=void 0===e.tool.config||e.tool.config.fontsize_enabled,e.availableFontSizes=[{name:"Lille",value:8},{name:"Normal",value:16},{name:"Stor",value:24},{name:"Meget stor",value:32}],e.editorCreated=function(t){t.clipboard.dangerouslyPasteHTML(e.slide.options.text)}},templateUrl:"/bundles/itktemplateextension/apps/templateExtensionModule/itk-rich-text.html"}}]),angular.module("templateExtensionModule").directive("itkKobaResourcePicker",["kobaFactory","busService","$timeout",function(e,t,i){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",template:"@"},link:function(i){i.availableResources=[],e.getResources().then(function(e){if(i.availableResources=e,i.slide.options.hasOwnProperty("resources"))for(var t=[],o=i.slide.options.resources.length,l=0;l<o;l++){for(var n=!1,s=0;s<e.length;s++)if(e[s].mail===i.slide.options.resources[l].mail){n=!0;break}n&&t.push(i.slide.options.resources[l])}i.slide.options.resources=t},function(e){t.$emit("log.error",{cause:e,msg:"Kunne ikke hente bookings for ressource."})})},templateUrl:function(e,t){return t.template?t.template:"/bundles/itktemplateextension/apps/templateExtensionModule/itk-koba-resource-picker.html"}}}]),angular.module("templateExtensionModule").directive("itkTextArray",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&"},link:function(e,t,i){e.newText={text:"",author:""},e.addText=function(){e.slide.options.texts||(e.slide.options.texts=[]),e.slide.options.texts.push(angular.copy(e.newText))},e.removeText=function(t){e.slide.options.texts.splice(t,1)}},templateUrl:"/bundles/itktemplateextension/apps/templateExtensionModule/itk-text-array.html"}}]),angular.module("templateExtensionModule").directive("itkColorPicker",["$timeout","$http",function(e,t){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(i){i.selectColor=function(e,t){i.slide.options[e]=t.value},i.themes=[],i.fields=i.tool.config.fields,t.get("/api/itk_template_extension/theme_colors").then(function(t){e(function(){i.themes=t.data})})},templateUrl:"/bundles/itktemplateextension/apps/templateExtensionModule/itk-color-picker.html"}}]),angular.module("templateExtensionModule").directive("itkMediaPicker",["mediaFactory","$timeout",function(e,t){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&",tool:"="},link:function(t){var i=t.tool.config,o=null;function l(e){for(var i=[],o=e.length-1;o>=0;o--){var l=!1,n=null;for(n in t.fields)t.fields.hasOwnProperty(n)&&(n=t.fields[n],t.slide.options[n.field]===o&&(i.push(e[o]),l=!0));if(!l){e.splice(o,1);for(n in t.fields)t.fields.hasOwnProperty(n)&&(n=t.fields[n],t.slide.options[n.field]>o&&(t.slide.options[n.field]=t.slide.options[n.field]-1))}}}t.fields=i.fields,t.step=null,t.selectedMedia=[],t.selectedMediaType=null,t.removeMedia=function(e){t.slide.options[e]=null,l(t.slide.media)},t.backgroundPicker=function(e,i){o=e,t.selectedMediaType=i||"image",t.step="background-picker"},t.pickFromMedia=function(){var e=t.slide.options[o];""!==e&&null!==e&&void 0!==e&&(t.selectedMedia=[t.slide.media[e]]),t.step="pick-from-media"},t.pickFromComputer=function(){t.step="pick-from-computer"},t.back=function(){t.selectedMedia=[],t.step=null,o=null};t.$on("mediaOverview.selectMedia",function(e,i){!function(e){var i=[],n=!1,s=null;for(var a in t.slide.media){var r=t.slide.media[a];r.id===e.id&&(n=!0,s=parseInt(a)),i.push(r)}n||(i.push(e),s=i.length-1),t.slide.options[o]=s,l(i),t.step=null,t.slide.media=i}(i)}),t.$on("mediaUpload.uploadSuccess",function(i,l){e.getMedia(l.id).then(function(e){t.slide.media.push(e),t.slide.options[o]=t.slide.media.length-1},function(e){busService.$emit("log.error",{cause:e,msg:"Kunne ikke tilf√∏je media."})})})},templateUrl:"/bundles/itktemplateextension/apps/templateExtensionModule/itk-media-picker.html"}}]);